#!/bin/bash

set -euo pipefail

APP_NAME="HARDN-XDR"
VERSION="2.0.0"

MAIN_SCRIPT="/usr/lib/hardn-xdr/hardn-main.sh"

show_help() {
    cat <<EOF
$APP_NAME $VERSION

Usage: $(basename "$0") [command]

Commands:
  start         Run the main HARDN-XDR security hardening script.
  stop          (Not yet implemented)
  status        (Not yet implemented)
  help          Show this help message

Example:
  sudo $(basename "$0") start
EOF
}

start_service() {
    if [ ! -f "$MAIN_SCRIPT" ]; then
        echo "ERROR: Main script not found at $MAIN_SCRIPT"
        echo "The package may be installed incorrectly."
        exit 1
    fi

    echo "Executing the main HARDN-XDR script..."

    chmod +x "$MAIN_SCRIPT"
    "$MAIN_SCRIPT"
}


if [ "$(id -u)" -ne 0 ]; then
    echo "This script must be run as root. Please use sudo."
    exit 1
fi

case "${1:-}" in
    start)
        start_service
        ;;
    stop)
        echo "Stop command is not yet implemented."
        ;;
    status)
        echo "Status command is not yet implemented."
        ;;
    help|-h|--help|"")
        show_help
        ;;
    *)
        echo "Unknown command: $1"
        show_help
        exit 1
        ;;
esac
